# Documentation for the `datacut_sas` package.
  
----------------------------------------------------------------
 
 *datacut_sas* 
  
----------------------------------------------------------------
 
### Version information:
  
- Package: datacut_sas
- Version: 0.1.0
- Generated: 2025-11-09T22:03:41
- Author(s): Yutaka Morioka(sasyupi@gmail.com)
- Maintainer(s): Yutaka Morioka(sasyupi@gmail.com)
- License: MIT
- File SHA256: `F*F77D9E8D94124104955F57A4E563057989A1A2F77104EEAEEBA2412E39AC75BD` for this version
- Content SHA256: `C*79ACC2E8C4C8F4A48C722F047A3909A615361B4D59FB542A6207E6C69884D130` for this version
  
---
 
# The `datacut_sas` package, version: `0.1.0`;
  
---
 
SAS macros to prepare SDTM for data-cut analyses: remove post-cutoff records, overwrite with the cutoff date/time, drop subjects, and null flags. Supports multiple cutoff operations and generates an Excel report summarizing all applied changes.
  
---
 
  
---
 
Required SAS Components: 
  - Base SAS Software
  
---
 
 
--------------------------------------------------------------------
 
*SAS package generated by SAS Package Framework, version `20250729`*
 
--------------------------------------------------------------------
 
# The `datacut_sas` package content
The `datacut_sas` package consists of the following content:
 
1. [`%cutoff_delete()` macro ](#cutoffdelete-macro-1 )
2. [`%cutoff_missing()` macro ](#cutoffmissing-macro-2 )
3. [`%cutoff_overwrite()` macro ](#cutoffoverwrite-macro-3 )
4. [`%cutoff_setting()` macro ](#cutoffsetting-macro-4 )
5. [`%delete_participants()` macro ](#deleteparticipants-macro-5 )
6. [`%output_and_report()` macro ](#outputandreport-macro-6 )
  
 
7. [License note](#license)
  
---
 
## `%cutoff_delete()` macro <a name="cutoffdelete-macro-1"></a> ######

Macro: cutoff_delete
  Purpose:
    Delete records where a date/datetime variable is strictly greater than
    the cutoff value.
  Parameters:
    domain=   Target dataset (e.g., DM)
    var=      Variable to compare (e.g., RFICDTC)
    type=     DATE | DATETIME
  Audit:
    - Starts dataset audit, deletes records, writes audit to audit_<domain>,
      and terminates audit.
  Notes:
    - Comparison is string-based as written; ensure ISO 8601 formatting for safety.
  Usage Example:  
  %cutoff_delete(domain=ae, var=AESTDTC, type=DATE);

  
---
 
## `%cutoff_missing()` macro <a name="cutoffmissing-macro-2"></a> ######

Macro: cutoff_missing
  Purpose:
    Set a target variable to missing when a reference date/datetime variable
    is strictly greater than the cutoff.
  Parameters:
    domain=       Target dataset (e.g., DM)
    ref_var=      Variable used for comparison to the cutoff (e.g., DTHDTC)
    missing_var=  Variable to set missing (e.g., DTHFL or DTHDTC)
    type=         DATE | DATETIME
  Audit:
    - Starts dataset audit, updates the target variable to missing,
      writes audit to audit_<domain>, and terminates audit.
  Usage Example:  
  %cutoff_missing(domain=dm, ref_var=DTHDTC ,missing_var=DTHFL, type=DATE);
  %cutoff_missing(domain=dm, ref_var=DTHDTC ,missing_var=DTHDTC, type=DATE);

  
---
 
## `%cutoff_overwrite()` macro <a name="cutoffoverwrite-macro-3"></a> ######

Purpose:
    Overwrite values in a date/datetime variable with the cutoff value when
    the existing value is strictly greater than the cutoff.
  Parameters:
    domain=   Target dataset (e.g., DM)
    var=      Variable to overwrite (e.g., RFSTDTC/RFPENDTC/RFXSTDTC)
    type=     DATE | DATETIME (controls comparison and assigned value)
  Audit:
    - Starts dataset audit, applies update, materializes audit trail into
      audit_<domain>, and terminates audit.
  Notes:
    - Comparison is string-based as written; ensure ISO 8601 formatting for safety.
  Usage Example:
  %cutoff_overwrite(domain=dm, var=RFPENDTC, type=DATE);
  %cutoff_overwrite(domain=dm, var=RFXSTDTC, type=DATETIME);

  
---
 
## `%cutoff_setting()` macro <a name="cutoffsetting-macro-4"></a> ######

Macro: cutoff_setting
  Purpose:
    Initialize the cutoff environment:
      - Save cutoff date/datetime to global macro variables
      - Clear WORK and target OUTLIB (optional) libraries
      - Copy all datasets from input library to WORK
  Parameters:
    inlib=           Path or libref of the input library to copy from
    outlib=          Path or libref of the output library to export later
    cutoff_date=     Cutoff date in ISO 8601 (YYYY-MM-DD)
    cutoff_datetime= Cutoff datetime in ISO 8601 (YYYY-MM-DDThh:mm[[:ss]])
  Globals Created:
    cutoff__date, cutoff__datetime
  Side Effects:
    - Deletes all DATA members in WORK (and DATA members in c_outlib)
    - Creates librefs c_inlib and c_outlib
  Notes:
    - This macro does not perform any transformations, only environment setup.
  Usage Example:  
      %cutoff_setting(
      inlib = D:\in
      ,outlib=D:\out
      ,cutoff_date=2025-11-01
      ,cutoff_datetime=2022-11-01T00:00
      );

  
---
 
## `%delete_participants()` macro <a name="deleteparticipants-macro-5"></a> ######

Macro: delete_participants
  Purpose:
    Delete records for participants listed in a separate dataset (USUBJID-level).
  Parameters:
    domain=          Target dataset (e.g., DM)
    delete_list_ds=  Dataset with a column USUBJID listing rows to delete
  Audit:
    - Starts dataset audit, deletes by IN-subquery, writes audit to audit_<domain>,
      and terminates audit.
  Notes:
    - Assumes the key variable is USUBJID.
  Usage Example:  
 %delete_participants(domain=dm ,delete_list_ds=dlds);

  
---
 
## `%output_and_report()` macro <a name="outputandreport-macro-6"></a> ######

Macro: output_and_report
  Purpose:
    Export all WORK datasets to the configured output library and create an
    Excel report summarizing the audit trails.
  Parameters:
    report_path=  Folder path to write the Excel report (cutoff_report.xlsx)
    exclude=      Names to exclude when copying from WORK to c_outlib
  Outputs:h
    - Excel file: &report_path\cutoff_report.xlsx
    - Datasets: all WORK datasets (except excluded) copied to c_outlib
  Notes:
    - Consumes audit_* tables via SET audit_:
    - Adds cutoff date/time text blocks to the report.
 Usage Example
 %output_and_report(report_path=D:\audit_test\out, exclude=dlds);

  
---
 
  
---
 
# License <a name="license"></a> ######
 
	Copyright (c) [2025]  [Yutaka Morioka]

Permission is hereby granted, free of charge, to any person obtaining a copy   
of this software and associated documentation files (the "Software"), to deal    
in the Software without restriction, including without limitation the rights   
to use, copy, modify, merge, publish, distribute, sublicense, and/or sell   
copies of the Software, and to permit persons to whom the Software is   
furnished to do so, subject to the following conditions:                      
                                                                                
The above copyright notice and this permission notice shall be included       
in all copies or substantial portions of the Software.                        
                                                                                
THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR    
IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,      
FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE   
AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER        
LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, 
OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE 
SOFTWARE.
  
---
 
